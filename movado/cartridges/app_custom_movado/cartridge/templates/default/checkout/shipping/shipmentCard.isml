<isif condition="${pdict.order.amzPayRedirectURL}">
    <isset name="addressMode" value="${'new'}" scope="page" />
<iselse/>
    <isset name="addressMode" value="${shippingModel.matchingAddressId ? 'edit' : 'new'}" scope="page" />
</isif>
<div class="card-body shipping-content card-shipping-container-wrapper">
<isif condition="${session.privacy.pickupFromStore}">
    <div class="row">
        <div class="col-12 shipping-details-label">
            <div class="shipping-your-detail">
                ${Resource.msg('label.order.your.detail', 'storePickUp', null)}
            </div>
        </div>
    </div>
</isif>
    <form class="shipping-form" autocomplete="on" novalidate
          action="${shipmentLoopState
          ? URLUtils.url('CheckoutAddressServices-AddNewAddress')
          : URLUtils.url('CheckoutShippingServices-SubmitShipping')}"
          data-address-mode="${addressMode}"
          <isprint value=${pdict.forms.shippingForm.attributes} encoding="off"/>
    >
        <isif condition="${lineItem}">
            <input name="productLineItemUUID" type="hidden" value="${lineItem.UUID}" />
        </isif>

        <input name="originalShipmentUUID" type="hidden" value="${shippingModel.UUID}" />
        <input name="shipmentUUID" type="hidden" value="${shippingModel.UUID}" />

        <div class="shipping-address ${pdict.order.usingMultiShipping ? 'd-none' : ''}">
            <fieldset class="shipment-selector-block ${(pdict.order.usingMultiShipping || shipmentLoopState) || (pdict.customer.addresses && pdict.customer.addresses.length > 0) ? '' : 'd-none'} ">
                <isinclude template="checkout/shipping/shipmentSelector" />
            </fieldset>

            <fieldset class="shipping-address-block">
                <isinclude template="checkout/shipping/shippingAddress" />
            </fieldset>

            <isif condition="${session.privacy.pickupFromStore}">
                <div class="row">
                    <div class="col-12 pickup-store-container">
                        <isinclude url="${URLUtils.url('Checkout-CheckoutPickupStore')}" />
                    </div>
                </div>
            <iselse/>
                <fieldset class="shipping-method-block mx-shipping-box shipping-method-box-wrapper">
                    <div class="row">
                        <div class="col-12 col-wrapper-space-left new-shipping-sec">
                            <h5 class="ship-method-header">${Resource.msg('heading.shipping.method', 'checkout', null)}</h5>

                            <div class="shipping-slot-data">
                                <isslot id="cs-shipping-method-slot" description="" context="global" />   
                            </div>
                               
                            <isinclude template="checkout/shipping/shippingMethod" />
                        </div>
                    </div>
                </fieldset>
            </isif>

            <iscomment> <fieldset class="gift-message-block">
                <isinclude template="checkout/shipping/isGift" />
            </fieldset> </iscomment>
        </div>

        
        <div class="view-address-block ${shippingModel.shippingAddress ? '' : 'd-none' }">
            <isinclude template="checkout/shipping/shippingCard" />
        </div>

        <isinclude template="checkout/shipping/multiShippingButtons" />

        <input type="hidden" name="${pdict.csrf.tokenName}" value="${pdict.csrf.token}"/>
    </form>
</div>
