<div class="image-container">
    <!-- First two conditions are for PLP and the last is applicable on PDP -->
    <isif condition="${(product.defaultVariantAvailabilityStatus === 'IN_STOCK' && pdict.display.plpTile === true)}">
        <isloop items="${product.defaultVariantBadges.imageBadges}" var="imageBadge" status="loopStatus">
            <isif condition="${loopStatus.first}">
                <div class="product-badge left"><span class="badge-text"><img src="${imageBadge.imageUrl}" alt="${imageBadge.imageAlt}" /></span></div>
            <iselseif condition="${loopStatus.last}">
                <div class="product-badge right"><span class="badge-text"><img src="${imageBadge.imageUrl}" alt="${imageBadge.imageAlt}" /></span></div>
            </isif>
        </isloop>
    <iselseif condition="${(product.available && pdict.display.plpTile === true && product.productType !== 'master') || (product.available && pdict.display.plpTile === false)}">
        <isloop items="${product.badges.imageBadges}" var="imageBadge" status="loopStatus">
            <isif condition="${loopStatus.first}">
                <div class="product-badge left"><span class="badge-text"><img src="${imageBadge.imageUrl}" alt="${imageBadge.imageAlt}" /></span></div>
            <iselseif condition="${loopStatus.last}">
                <div class="product-badge right"><span class="badge-text"><img src="${imageBadge.imageUrl}" alt="${imageBadge.imageAlt}" /></span></div>
            </isif>
        </isloop>
    </isif>
    <div class="plp-image-carousel">
        <isif condition="${product && product.images && !pdict.display.plpTile && product.productType != 'master'}">
            <a href="${pdict.urls.product}" class="${product.promotionObj ? 'gtm-promotion-view': ''}" data-page-type="${session.custom.gtmPageType}" data-gtm-product-promo="${product.promotionObj}">
                <picture>
                    <isif condition="${product.images.tile256[0]}"><source media="(min-width: 992px)" srcset="${product.images.tile256[0].url}" /></isif>
                    <isif condition="${product.images.tile256[0]}"><source media="(min-width: 544px)" srcset="${product.images.tile256[0].url}" /></isif>
                    <isif condition="${product.images.tile256[0]}"><source media="(min-width: 320px)" srcset="${product.images.tile256[0].url}" /></isif>
                    <isif condition="${product.images.tile256[0]}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.images.tile256[0].url}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                </picture>
            </a>
        <iselseif condition="${product && product.images && (product.productType != 'master' || !product.variationPdpURL)}" >
            <isif condition="${pdict.display.isLifeStyleEnabled}">
                <a href="${pdict.urls.product}" class="${product.promotionObj ? 'gtm-promotion-view': ''}" data-gtm-product-promo="${product.promotionObj}" data-page-type="${session.custom.gtmPageType}">
                    <picture>
                        <isif condition="${pdict.display.isEnableSingleProductRow && pdict.display.isNonWatchesTileEnable}">
                            <isif condition="${product.images.tile256[0]}"><source media="(min-width: 992px)" srcset="${product.images.tile256[0].url}" /></isif>
                            <isif condition="${product.images.tile256[0]}"><source media="(min-width: 544px)" srcset="${product.images.tile256[0].url}" /></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow && !pdict.display.isNonWatchesTileEnable}"/>
                            <isif condition="${product.images.tile512X640[0]}"><source media="(min-width: 992px)" srcset="${product.images.tile512X640[0].url}" /></isif>
                            <isif condition="${product.images.tile512X640[0]}"><source media="(min-width: 544px)" srcset="${product.images.tile512X640[0].url}" /></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow}"/>
                            <isif condition="${product.images.tile256[0]}"><source media="(min-width: 992px)" srcset="${product.images.tile256[0].url}" /></isif>
                            <isif condition="${product.images.tile256[0]}"><source media="(min-width: 544px)" srcset="${product.images.tile256[0].url}" /></isif>
                        </isif>

                        <isif condition="${pdict.display.isEnableSingleProductRow && pdict.display.isNonWatchesTileEnable}" >
                            <isif condition="${product.images.tile256[0]}"><source media="(min-width: 320px)"  srcset="${product.images.tile256[0].url}" /></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow && !pdict.display.isNonWatchesTileEnable}"/>
                            <isif condition="${product.images.tile300X375[0]}"><source media="(min-width: 320px)"  srcset="${product.images.tile300X375[0].url}" /></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow}"/>
                            <isif condition="${product.images.tile300X300[0]}"><source media="(min-width: 320px)" srcset="${product.images.tile300X300[0].url}" /></isif>
                        </isif>


                        <isif condition="${pdict.display.isNonWatchesTileEnable && pdict.display.isNonWatchesTileEnable}">
                            <isif condition="${product.images.tile256[0]}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.images.tile256[0].url}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                        <iselseif condition="${!pdict.display.isNonWatchesTileEnable && !pdict.display.isNonWatchesTileEnable}"/>
                            <isif condition="${product.images.tile512X640[0]}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.images.tile512X640[0].url}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow}"/>
                            <isif condition="${product.images.tile256[0]}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.images.tile256[0].url}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                        </isif>
                    </picture>
                </a>
            <iselse/>
                <a href="${pdict.urls.product}" class="${product.promotionObj ? 'gtm-promotion-view': ''}" data-page-type="${session.custom.gtmPageType}" data-gtm-product-promo="${product.promotionObj}">
                    <picture>
                        <isif condition="${product.images.tile256[0]}"><source media="(min-width: 992px)" srcset="${product.images.tile256[0].url}" /></isif>
                        <isif condition="${product.images.tile256[0]}"><source media="(min-width: 544px)" srcset="${product.images.tile256[0].url}" /></isif>
                        <isif condition="${product.images.tile256[0]}"><source media="(min-width: 320px)" srcset="${product.images.tile256[0].url}" /></isif>
                        <isif condition="${product.images.tile256[0]}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.images.tile256[0].url}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                    </picture>
                </a>
            </isif>
            <isif condition="${pdict.display.isLifeStyleEnabled && !empty(product.images.tile512X640[3])}">
                <a href="${pdict.urls.product}" class="${product.promotionObj ? 'gtm-promotion-view': ''}" data-gtm-product-promo="${product.promotionObj}" data-page-type="${session.custom.gtmPageType}">
                    <picture class="life-style-image">

                        <isif condition="${pdict.display.isEnableSingleProductRow && pdict.display.isNonWatchesTileEnable}">
                            <isif condition="${product.images.tile256[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 992px)" data-lazy="${product.images.tile256[3].url}" /></isif>
                            <isif condition="${product.images.tile256[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 544px)" data-lazy="${product.images.tile256[3].url}" /></isif>
                            <isif condition="${product.images.tile256[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 320px)" data-lazy="${product.images.tile256[3].url}" /></isif>
                            <isif condition="${product.images.tile256[3]}"><img src="${URLUtils.staticURL('/images/1x1.png')}" class="tile-image gtm-product" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}'/></isif>
                        
                        <iselse>
                            <isif condition="${pdict.display.isNonWatchesTileEnable}">
                                <isif condition="${product.images.tile256[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 992px)" data-lazy="${product.images.tile256[3].url}" /></isif>
                                <isif condition="${product.images.tile256[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 544px)" data-lazy="${product.images.tile256[3].url}" /></isif>
                                <isif condition="${product.images.tile300X300[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 320px)" data-lazy="${product.images.tile300X300[3].url}" /></isif>
                                <isif condition="${product.images.tile256[3]}"><img src="${URLUtils.staticURL('/images/1x1.png')}" class="tile-image gtm-product" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)} '/></isif>                                
                            <iselse/>
                                <isif condition="${product.images.tile512X640[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 992px)" data-lazy="${product.images.tile512X640[3].url}" /></isif>
                                <isif condition="${product.images.tile512X640[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 544px)" data-lazy="${product.images.tile512X640[3].url}" /></isif>
                                <isif condition="${product.images.tile300X375[3]}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 320px)" data-lazy="${product.images.tile300X375[3].url}" /></isif>
                                <isif condition="${product.images.tile512X640[3]}"><img src="${URLUtils.staticURL('/images/1x1.png')}" class="tile-image gtm-product" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}'/></isif>                                                                
                            </isif>
                        </isif>
                    </picture>
                </a>
            </isif>
        <iselse>

            <isif condition="${pdict.display.isLifeStyleEnabled && !empty(product.defaultVariantLifeStyleImage)}">
                    <a href="${product.variationPdpURL}" class="${product.promotionObj ? 'gtm-promotion-view': ''}" data-page-type="${session.custom.gtmPageType}" data-gtm-product-promo="${product.promotionObj}">
                        <picture>
                            <isif condition="${pdict.display.isEnableSingleProductRow && pdict.display.isNonWatchesTileEnable}">
                                <isif condition="${product.defaultVariantImageDIS}"><source media="(min-width: 992px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                                <isif condition="${product.defaultVariantImageDIS}"><source media="(min-width: 544px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                                <isif condition="${product.defaultVariantImageDIS}"><source media="(min-width: 320px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                                <isif condition="${product.defaultVariantImageDIS}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${defaultVariantImageDIS}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>

                            <iselse>
                                <isif condition="${pdict.display.isNonWatchesTileEnable}">
                                    <isif condition="${product.defaultVariantImageDIS}"><source media="(min-width: 992px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                                    <isif condition="${product.defaultVariantImageDIS}"><source media="(min-width: 544px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                                    <isif condition="${product.defaultVariantTileImage300X300}"><source media="(min-width: 320px)" srcset="${product.defaultVariantTileImage300X300}" /></isif>
                                    <isif condition="${product.defaultVariantImageDIS}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${defaultVariantImageDIS}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>

                                <iselse/>
                                    <isif condition="${product.defaultVariantTile512X640}"><source media="(min-width: 992px)" srcset="${product.defaultVariantTile512X640}" /></isif>
                                    <isif condition="${product.defaultVariantTile512X640}"><source media="(min-width: 544px)" srcset="${product.defaultVariantTile512X640}" /></isif>
                                    <isif condition="${product.defaultVariantTileImage300X375}"><source media="(min-width: 320px)" srcset="${product.defaultVariantTileImage300X375}" /></isif>
                                    <isif condition="${product.defaultVariantTile512X640}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.defaultVariantTile512X640}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>

                                </isif>
                            </isif>
                        </picture>
                    </a>
                    <a href="${pdict.urls.product}" class="${product.promotionObj ? 'gtm-promotion-view': ''}" data-gtm-product-promo="${product.promotionObj}" data-page-type="${session.custom.gtmPageType}">
                        <picture class="life-style-image">

                            <isif condition="${pdict.display.isEnableSingleProductRow && pdict.display.isNonWatchesTileEnable}">
                                <isif condition="${product.defaultVariantLifeStyleImage512x512}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 992px)" data-lazy="${product.defaultVariantLifeStyleImage512x512}" /></isif>
                                <isif condition="${product.defaultVariantLifeStyleImage512x512}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 544px)" data-lazy="${product.defaultVariantLifeStyleImage512x512}" /></isif>
                                <isif condition="${product.defaultVariantLifeStyleImage512x512}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 320px)" data-lazy="${product.defaultVariantLifeStyleImage512x512}" /></isif>
                                <isif condition="${product.defaultVariantLifeStyleImage512x512}"><img src="${URLUtils.staticURL('/images/1x1.png')}" class="tile-image gtm-product" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}'/></isif>
                            <iselse>
                                <isif condition="${pdict.display.isNonWatchesTileEnable}">
                                    <isif condition="${product.defaultVariantLifeStyleImage512x512}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 992px)" data-lazy="${product.defaultVariantLifeStyleImage512x512}" /></isif>
                                    <isif condition="${product.defaultVariantLifeStyleImage512x512}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 544px)" data-lazy="${product.defaultVariantLifeStyleImage512x512}" /></isif>
                                    <isif condition="${product.defaultVariantLifeStyleImage300X300}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 320px)" data-lazy="${product.defaultVariantLifeStyleImage300X300}" /></isif>
                                    <isif condition="${product.defaultVariantLifeStyleImage512x512}"><img src="${URLUtils.staticURL('/images/1x1.png')}" class="tile-image gtm-product" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}'/></isif>
                                <iselse/>
                                    <isif condition="${product.defaultVariantLifeStyleImage}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 992px)" data-lazy="${product.defaultVariantLifeStyleImage}" /></isif>
                                    <isif condition="${product.defaultVariantLifeStyleImage}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 544px)" data-lazy="${product.defaultVariantLifeStyleImage}" /></isif>
                                    <isif condition="${product.defaultVariantLifeStyleImage300X375}"><source srcset="${URLUtils.staticURL('/images/1x1.png')}" media="(min-width: 320px)" data-lazy="${product.defaultVariantLifeStyleImage300X375}" /></isif>                 
                                    <isif condition="${product.defaultVariantLifeStyleImage}"><img src="${URLUtils.staticURL('/images/1x1.png')}" class="tile-image gtm-product" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' /></isif>
                                </isif>
                            </isif>                            
                        </picture>
                    </a>

                <iselse/>
                
                    <a href="${product.variationPdpURL}" class="${product.promotionObj ? 'gtm-promotion-view': ''}" data-page-type="${session.custom.gtmPageType}" data-gtm-product-promo="${product.promotionObj}">
                        <picture>
                        <isif condition="${pdict.display.isEnableSingleProductRow && pdict.display.isNonWatchesTileEnable}">
                            <isif condition="${product.defaultVariantImageDIS}"><source media="(min-width: 320px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow && !pdict.display.isNonWatchesTileEnable}"/>
                            <isif condition="${product.defaultVariantTile512X640}"><source  media="(min-width: 992px)" srcset="${product.defaultVariantTile512X640}" /></isif>
                            <isif condition="${product.defaultVariantTile512X640}"><source  media="(min-width: 544px)" srcset="${product.defaultVariantTile512X640}" /></isif>
                            <isif condition="${product.defaultVariantTileImage300X375}"><source media="(min-width: 320px)" srcset="${product.defaultVariantTileImage300X375}" /></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow}"/>
                            <isif condition="${product.defaultVariantImageDIS}"><source  media="(min-width: 992px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                            <isif condition="${product.defaultVariantImageDIS}"><source  media="(min-width: 544px)" srcset="${product.defaultVariantImageDIS}" /></isif>
                            <isif condition="${product.defaultVariantTileImage300X300}"><source media="(min-width: 320px)" srcset="${product.defaultVariantTileImage300X300}" /></isif>
                        </isif>

                        <isif condition="${pdict.display.isEnableSingleProductRow && pdict.display.isNonWatchesTileEnable}">
                            <isif condition="${product.defaultVariantImageDIS}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.defaultVariantImageDIS}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow && !pdict.display.isNonWatchesTileEnable}"/>
                             <isif condition="${product.defaultVariantTile512X640}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.defaultVariantTile512X640}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                        <iselseif condition="${!pdict.display.isEnableSingleProductRow}"/>
                            <isif condition="${product.defaultVariantImageDIS}"><img class="tile-image gtm-product" loading="${pdict.display.lazyload ? 'lazy' : ''}" src="${product.defaultVariantImageDIS}" alt="${product.productName}" itemprop="image"  data-gtm-product='${JSON.stringify(pdict.productClickGtmObj)}' data-gtm-facets='${JSON.stringify(pdict.productGtmObj)}'/></isif>
                        </isif>
                        </picture>
                    </a>
            </isif>
        </isif>
    </div>
    <isif condition="${product.promotions && !empty(product.promotions)}">
    <div class="promotion-badge-box">
        <isloop items="${product.promotions}" var="promotion">
            <isif condition="${promotion.promotionClass === dw.campaign.Promotion.PROMOTION_CLASS_PRODUCT && promotion.promotionBadge &&  !empty(promotion.promotionMsg)}">
                <div class="product-badge-main">
                    <span class="badge custom-promotion-badge text-uppercase">${promotion.promotionMsg}</span>
                </div>
            </isif>
        </isloop>
    </div>
    </isif>
    <isif condition="${!empty(product.saveMessage)}">
        <div class="product-tag-content">
            <div class="exclusive-badges exclusive-badge-search">
                <span class="badge text-uppercase">${product.saveMessage}</span>
            </div>
        </div>
    <iselse/>
        <div class="product-tag-content ${pdict.display.recommendattionTile ? 'd-none' : ''} ${!empty(outOfStock) || !empty(product.badges.textBadges && product.badges.textBadges.length > 0) || !empty(product.defaultVariantBadges.textBadges && product.defaultVariantBadges.textBadges.length > 0) ? '' : 'd-none'}">
            <isinclude template="product/components/badges" />
        </div>
    </isif>
</div>
